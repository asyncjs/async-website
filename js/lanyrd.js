!function(e,t,n){"use strict";function r(e){e=u.isArray(e)?e:[e];for(var t,n=0,o=e.length;n<o;n+=1)t=e[n],(t instanceof r||t instanceof i)&&(t=t.get()),this[n]=t;this.length=e.length}function i(e){e=e||{},this.url=e.url,this.data=e.data||{};var t=e.deferred||u.deferred();this.url&&(this.fetch=function(e,n){if(this.state()!==i.PENDING)return this;var r,a,c=this.url;return o.requestType===u.request.JSONP&&(c+=(c.indexOf("?")<0?"?":"&")+"callback=?"),r=u.request(c),a=this,r.done(function(){a.data=r.data,t.resolveWith(a,[a,r])}),r.fail(function(){t.rejectWith(a,[a,r])}),this.then(e,n)}),t.promise(this)}var o,u,a,c;u={a:n.document&&n.document.createElement("a"),isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},each:function(e,t,n){var r,i=0,o=e.length;if("number"==typeof o)for(;i<o;i+=1)r=e[i],t.call(n||r,r,i,e);else for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r=e[i],t.call(n||r,r,i,e));return e},keys:function(e){return u.map(e,function(e,t){return t})},map:function(e,t,n){var r=[];return u.each(e,function(e){r.push(t?t.apply(this,arguments):e)},n),r},filter:function(e,t,n){var r=[];return u.each(e,function(e){t.apply(this,arguments)&&r.push(e)},n),r},extend:function(e){for(var t,n,r=arguments[0],i=Array.prototype.slice.call(arguments,1),o=i.length,u=0;u<o;u+=1){t=i[u];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},invoke:function(e,t){var n=[],r=[].slice.call(arguments,2);return u.each(e,function(e){n.push(e[t].apply(e,r))}),n},pluck:function(e,t,n){[].slice.call(arguments,2);return u.map(e,function(e){return u.keypath(e,t,n)})},deferred:function(){return t&&t.Deferred?new t.Deferred:new u._.Deferred},when:function(e){var n=1===arguments.length&&u.isArray(e)?e:arguments;return t&&t.Deferred?t.when.apply(t,n):u._.when.apply(u._,n)},request:function(e){var t=o.requestType,n=u.rawRequest(e,t),r=u.deferred(),i=r.promise({data:null,type:t,xhr:t===u.request.JSONP?null:n});return n.then(function(e){i.data=e,r[!e||e.error?"reject":"resolve"](i)},function(){r.reject(i)}),i},rawRequest:function(e,n){return n=n||"json",t?t.ajax({url:e,dataType:n}):a.utils[n](e)},escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},keypath:function(e,t,n,r){var i,o=(t||"").split(".");if(!t)return e;for(;e&&o.length&&(i=o.shift(),Object.prototype.hasOwnProperty.call(e,i)||r===!0&&void 0!==e[i]);)if(e=e[i],0===o.length&&void 0!==e)return e;return arguments.length>2?n:null},pathname:function(e){return u.a.href=e||"/",u.a.pathname}},u.request.JSON="json",u.request.JSONP="jsonp",r.prototype={constructor:r,get:function(e,t){return u.keypath(this[0],e,t)},escape:function(e,t){return u.escape(this.get(e,t))},related:function(e){var t,n=e.split("."),r=n.pop();return n.push("api_urls"),t=this.get(n.join("."),{})[r],t||(t=this.get(e)),t?new i({url:t}):i.noop()},fetchRelated:function(e,t,n){return this.related(e).fetch(t,n)},fetchAllRelated:function(e,n,r){function i(t){return t.fetchRelated(e)}var o=u.deferred();return t.when.apply(t,this.map(i)).then(function(){var e=[],n=[];t.each(arguments,function(){n.push(this[1]),e.push(this[0])}),o.resolve(e,n)},o.reject),o.promise().then(n,r)},at:function(e){return e=e<0?e+this.length:e,this[e]||null}},u.each(["each","map","filter","pluck","invoke"],function(e){r.prototype[e]=function(){return u[e].apply(this,[].concat.apply(this,arguments))}}),i.PREV="prev",i.NEXT="next",i.RESOLVED="resolved",i.REJECTED="rejected",i.PENDING="pending",i.noop=function(e){var t=u.deferred(),n=new i(u.extend({deferred:t},e));return t.rejectWith(n,[n,null]),n},i.prototype={constructor:i,url:null,data:null,fetch:function(){return this},fetched:function(){return this.state&&this.state()===i.RESOLVED},related:function(e){return this.collection().related(e)},get:function(e,t){return u.keypath(this.data,e,t)},escape:function(e,t){return u.escape(this.get(e,t))},collection:function(e){var t=this.get(e);return t&&(t=new r(t)),t},paginate:function(e){var t=this.get("pagination.api_urls",{})[e];return t?new i({url:t}):i.noop()},paginated:function(){return this.get("pagination.num_pages",1)>1},first:function(){return 1===this.get("pagination.page",1)},last:function(){var e=this.get("pagination",{});return e.page===e.num_pages},next:function(e,t){return this.paginate(i.NEXT).fetch().then(e,t)},prev:function(e,t){return this.paginate(i.PREV).fetch().then(e,t)},all:function(e,t){function n(){function e(e,r){i-=1,i||(r?o.rejectWith(a,[a,r]):(a.data={},a.data[t]=n,o.resolveWith(a,[a])))}var t=r.get("pagination.paginated_key"),n=[],i=2;!function u(r){return r.flag||(r.flag=!0,o.notifyWith(r,arguments),n=r.get(t).slice().concat(n)),r.prev().then(u,e)}(r),function c(r){return r.flag||(r.flag=!0,o.notifyWith(r,arguments),n=n.concat(r.get(t))),r.next().then(c,e)}(r)}var r=this,o=u.deferred(),a=new i({deferred:o});return this.fetched()?n():this.fetch().always(n),a.then(e,t)}},a={API_DOMAIN:"http://lanyrd.asyncjs.com",conference:function(e){return this.resource({url:this.url(e)})},person:function(e){var t=this.url(e).replace(/\/profile\//i,"/people/");return this.resource({url:t})},place:function(e){return this.resource({url:this.url(e)})},topic:function(e){return this.resource({url:this.url(e)})},collection:function(e){return new r(e)},resource:function(e){return new i(e)},url:function(e){return this.API_DOMAIN+u.pathname(e)},config:function(e){u.extend(o,e)},utils:u,noConflict:function(){return n.lanyrd=e,a},Collection:r,Resource:i},o={requestType:u.request.JSONP},"function"==typeof n.define&&n.define.amd?n.define("lanyrd",function(){return a}):n.exports?(require("./lanyrd/deferred")(u),require("./lanyrd/request")(u),c=require("url").parse,a.utils.pathname=function(e){return c(e).pathname},o.requestType=u.request.JSON,n.exports=a):n.lanyrd=a}(this.lanyrd,this.jQuery,"undefined"!=typeof module?module:this),function(){if(function(e){function t(e){var t,n,r=h[e]={};for(e=e.split(/\s+/),t=0,n=e.length;t<n;t++)r[e[t]]=!0;return r}var n={},r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,o=Array.prototype.forEach,u=Array.prototype.slice,a=function(e,t,i){var u,a,c;if(e)if(o&&e.forEach===o)e.forEach(t,i);else if(e.length===+e.length){for(a=0,c=e.length;a<c;a++)if(a in e&&t.call(i,e[a],a,e)===n)return}else for(u in e)if(r.call(e,u)&&t.call(i,e[u],u,e)===n)return},c=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},l={"[object Array]":"array","[object Function]":"function"},s=function(e){return e?l[i.call(e)]||"object":String(e)},f=("done fail isResolved isRejected promise then always pipe".split(" "),{}),h={};f.Callbacks=function(e){e=e?h[e]||t(e):{};var n,r,i,o,u,a=[],c=[],l=function(t){var n,r,i,o;for(n=0,r=t.length;n<r;n++)i=t[n],o=s(i),"array"===o?l(i):"function"===o&&(e.unique&&p.has(i)||a.push(i))},f=function(t,l){for(l=l||[],n=!e.memory||[t,l],r=!0,u=i||0,i=0,o=a.length;a&&u<o;u++)if(a[u].apply(t,l)===!1&&e.stopOnFalse){n=!0;break}r=!1,a&&(e.once?n===!0?p.disable():a=[]:c&&c.length&&(n=c.shift(),p.fireWith(n[0],n[1])))},p={add:function(){if(a){var e=a.length;l(arguments),r?o=a.length:n&&n!==!0&&(i=e,f(n[0],n[1]))}return this},remove:function(){if(a)for(var t=arguments,n=0,i=t.length;n<i;n++)for(var c=0;c<a.length&&(t[n]!==a[c]||(r&&c<=o&&(o--,c<=u&&u--),a.splice(c--,1),!e.unique));c++);return this},has:function(e){if(a)for(var t=0,n=a.length;t<n;t++)if(e===a[t])return!0;return!1},empty:function(){return a=[],this},disable:function(){return a=c=n=void 0,this},disabled:function(){return!a},lock:function(){return c=void 0,n&&n!==!0||p.disable(),this},locked:function(){return!c},fireWith:function(t,i){return c&&(r?e.once||c.push([t,i]):e.once&&n||f(t,i)),this},fire:function(){return p.fireWith(this,arguments),this},fired:function(){return!!n}};return p},f.Deferred=function(e){var t,n=f.Callbacks("once memory"),r=f.Callbacks("once memory"),i=f.Callbacks("memory"),o="pending",u={resolve:n,reject:r,notify:i},l={done:n.add,fail:r.add,progress:i.add,state:function(){return o},isResolved:n.fired,isRejected:r.fired,then:function(e,t,n){return s.done(e).fail(t).progress(n),this},always:function(){return s.done.apply(s,arguments).fail.apply(s,arguments),this},pipe:function(e,t,n){return f.Deferred(function(r){a({done:[e,"resolve"],fail:[t,"reject"],progress:[n,"notify"]},function(e,t){var n,i=e[0],o=e[1];c(i)?s[t](function(){n=i.apply(this,arguments),n&&c(n.promise)?n.promise().then(r.resolve,r.reject,r.notify):r[o+"With"](this===s?r:this,[n])}):s[t](r[o])})}).promise()},promise:function(e){if(e)for(var t in l)e[t]=l[t];else e=l;return e}},s=l.promise({});for(t in u)s[t]=u[t].fire,s[t+"With"]=u[t].fireWith;return s.done(function(){o="resolved"},r.disable,i.lock).fail(function(){o="rejected"},n.disable,i.lock),e&&e.call(s,s),s},f.when=function(e){function t(e){return function(t){r[e]=arguments.length>1?u.call(arguments,0):t,--l||s.resolveWith(s,r)}}function n(e){return function(t){a[e]=arguments.length>1?u.call(arguments,0):t,s.notifyWith(h,a)}}var r=u.call(arguments,0),i=0,o=r.length,a=new Array(o),l=o,s=o<=1&&e&&c(e.promise)?e:f.Deferred(),h=s.promise();if(o>1){for(;i<o;i++)r[i]&&r[i].promise&&c(r[i].promise)?r[i].promise().then(t(i),s.reject,n(i)):--l;l||s.resolveWith(s,r)}else s!==e&&s.resolveWith(s,o?[e]:[]);return h},"undefined"!=typeof module&&module.exports?module.exports=f:"undefined"!=typeof e._?e._.mixin(f):e._=f}(this),"undefined"!=typeof module&&module.exports){var e=module.exports;module.exports=function(t){t._=e}}}.call(this.lanyrd&&this.lanyrd.utils),function(e){function t(){var e,n=t.cached,r=null;if(n)return n();e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];do{n=e.shift();try{r=n(),t.cached=n;break}catch(i){}}while(e.length);return r}function n(e,n){var r=t(),i=lanyrd.utils.deferred();return r.open("GET",e,!0),r.onreadystatechange=function(){var e;if(4===r.readyState)try{r.status>=200&&r.status<300?(e=JSON.parse(r.responseText),i.resolve(e,r)):i.reject(r)}catch(t){i.reject(r,t)}},4!==r.readyState&&r.send(),i.promise(r).done(n)}function r(e,t){var n=lanyrd.utils.deferred(),r=document.createElement("script"),u="callback"+(o+=1);encodeURIComponent;return e=e.replace(/\?$/,u),window[u]=function(e){n.resolve(e),delete window[u]},r.src=e,r.onload=r.onreadystatechange=function(){r.readyState&&!/loaded|complete/.test(r.readyState)||(r.onload=r.onreadystatechange=null,r.parentNode.removeChild(r),r=void 0)},i.insertBefore(r,i.lastChild),setTimeout(n.reject,3e4),n.promise().done(t)}if("undefined"!=typeof module&&module.exports)return function(){var e=require("url"),t=require("http");module.exports=function(n){return n.json=n.jsonp=function(r,i){var o=e.parse(r),u=n.deferred(),a=u.promise();return a.xhr=t.get(o,function(e){var t=[];e.on("data",function(e){t.push(e)}),e.on("end",function(){try{e.statusCode>=200&&e.statusCode<300?u.resolve(JSON.parse(t.join()),e):u.reject(e)}catch(n){u.reject(e,n)}})}),a},n}}();var i=document.getElementsByTagName("head")[0],o=0;lanyrd.utils.json=n,lanyrd.utils.jsonp=r}(this.lanyrd&&this.lanyrd.utils);
//# sourceMappingURL=lanyrd.js.map
