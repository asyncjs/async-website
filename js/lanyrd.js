!function(e,t,n,r){"use strict";function i(e){e=a.isArray(e)?e:[e];for(var t,n=0,r=e.length;n<r;n+=1)t=e[n],(t instanceof i||t instanceof o)&&(t=t.get()),this[n]=t;this.length=e.length}function o(e){e=e||{},this.url=e.url,this.data=e.data||{};var t=e.deferred||a.deferred();this.url&&(this.fetch=function(e,n){if(this.state()!==o.PENDING)return this;var r,i,c=this.url;return u.requestType===a.request.JSONP&&(c+=(c.indexOf("?")<0?"?":"&")+"callback=?"),r=a.request(c),i=this,r.done(function(){i.data=r.data,t.resolveWith(i,[i,r])}),r.fail(function(){t.rejectWith(i,[i,r])}),this.then(e,n)}),t.promise(this)}var u,a,c,s;a={a:n.document&&n.document.createElement("a"),isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},each:function(e,t,n){var r,i=0,o=e.length;if("number"==typeof o)for(;i<o;i+=1)r=e[i],t.call(n||r,r,i,e);else for(i in e)e.hasOwnProperty(i)&&(r=e[i],t.call(n||r,r,i,e));return e},keys:function(e){return a.map(e,function(e,t){return t})},map:function(e,t,n){var r=[];return a.each(e,function(e){r.push(t?t.apply(this,arguments):e)},n),r},filter:function(e,t,n){var r=[];return a.each(e,function(e){t.apply(this,arguments)&&r.push(e)},n),r},extend:function(e){for(var t,n,r=arguments[0],i=Array.prototype.slice.call(arguments,1),o=i.length,u=0;u<o;u+=1){t=i[u];for(n in t)t.hasOwnProperty(n)&&(r[n]=t[n])}return r},invoke:function(e,t){var n=[],r=[].slice.call(arguments,2);return a.each(e,function(e){n.push(e[t].apply(e,r))}),n},pluck:function(e,t,n){[].slice.call(arguments,2);return a.map(e,function(e){return a.keypath(e,t,n)})},deferred:function(){return t&&t.Deferred?new t.Deferred:new a._.Deferred},when:function(e){var n=1===arguments.length&&a.isArray(e)?e:arguments;return t&&t.Deferred?t.when.apply(t,n):a._.when.apply(a._,n)},request:function(e){var t=u.requestType,n=a.rawRequest(e,t),r=a.deferred(),i=r.promise({data:null,type:t,xhr:t===a.request.JSONP?null:n});return n.then(function(e){i.data=e,r[!e||e.error?"reject":"resolve"](i)},function(){r.reject(i)}),i},rawRequest:function(e,n){return n=n||"json",t?t.ajax({url:e,dataType:n}):c.utils[n](e)},escape:function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},keypath:function(e,t,n,i){var o,u=(t||"").split(".");if(!t)return e;for(;e&&u.length&&(o=u.shift(),e.hasOwnProperty(o)||i===!0&&e[o]!==r);)if(e=e[o],0===u.length&&e!==r)return e;return arguments.length>2?n:null},pathname:function(e){return a.a.href=e||"/",a.a.pathname}},a.request.JSON="json",a.request.JSONP="jsonp",i.prototype={constructor:i,get:function(e,t){return a.keypath(this[0],e,t)},escape:function(e,t){return a.escape(this.get(e,t))},related:function(e){var t,n=e.split("."),r=n.pop();return n.push("api_urls"),t=this.get(n.join("."),{})[r],t||(t=this.get(e)),t?new o({url:t}):o.noop()},fetchRelated:function(e,t,n){return this.related(e).fetch(t,n)},fetchAllRelated:function(e,n,r){function i(t){return t.fetchRelated(e)}var o=a.deferred();return t.when.apply(t,this.map(i)).then(function(){var e=[],n=[];t.each(arguments,function(){n.push(this[1]),e.push(this[0])}),o.resolve(e,n)},o.reject),o.promise().then(n,r)},at:function(e){return e=e<0?e+this.length:e,this[e]||null}},a.each(["each","map","filter","pluck","invoke"],function(e){i.prototype[e]=function(){return a[e].apply(this,[].concat.apply(this,arguments))}}),o.PREV="prev",o.NEXT="next",o.RESOLVED="resolved",o.REJECTED="rejected",o.PENDING="pending",o.noop=function(e){var t=a.deferred(),n=new o(a.extend({deferred:t},e));return t.rejectWith(n,[n,null]),n},o.prototype={constructor:o,url:null,data:null,fetch:function(){return this},fetched:function(){return this.state&&this.state()===o.RESOLVED},related:function(e){return this.collection().related(e)},get:function(e,t){return a.keypath(this.data,e,t)},escape:function(e,t){return a.escape(this.get(e,t))},collection:function(e){var t=this.get(e);return t&&(t=new i(t)),t},paginate:function(e){var t=this.get("pagination.api_urls",{})[e];return t?new o({url:t}):o.noop()},paginated:function(){return this.get("pagination.num_pages",1)>1},first:function(){return 1===this.get("pagination.page",1)},last:function(){var e=this.get("pagination",{});return e.page===e.num_pages},next:function(e,t){return this.paginate(o.NEXT).fetch().then(e,t)},prev:function(e,t){return this.paginate(o.PREV).fetch().then(e,t)},all:function(e,t){function n(){function e(e,r){o-=1,o||(r?i.rejectWith(u,[u,r]):(u.data={},u.data[t]=n,i.resolveWith(u,[u])))}var t=r.get("pagination.paginated_key"),n=[],o=2;!function a(r){return r.flag||(r.flag=!0,i.notifyWith(r,arguments),n=r.get(t).slice().concat(n)),r.prev().then(a,e)}(r),function c(r){return r.flag||(r.flag=!0,i.notifyWith(r,arguments),n=n.concat(r.get(t))),r.next().then(c,e)}(r)}var r=this,i=a.deferred(),u=new o({deferred:i});return this.fetched()?n():this.fetch().always(n),u.then(e,t)}},c={API_DOMAIN:"http://lanyrd.asyncjs.com",conference:function(e){return this.resource({url:this.url(e)})},person:function(e){var t=this.url(e).replace(/\/profile\//i,"/people/");return this.resource({url:t})},place:function(e){return this.resource({url:this.url(e)})},topic:function(e){return this.resource({url:this.url(e)})},collection:function(e){return new i(e)},resource:function(e){return new o(e)},url:function(e){return this.API_DOMAIN+a.pathname(e)},config:function(e){a.extend(u,e)},utils:a,noConflict:function(){return n.lanyrd=e,c},Collection:i,Resource:o},u={requestType:a.request.JSONP},"function"==typeof n.define&&n.define.amd?n.define("lanyrd",function(){return c}):n.exports?(require("./lanyrd/deferred")(a),require("./lanyrd/request")(a),s=require("url").parse,c.utils.pathname=function(e){return s(e).pathname},u.requestType=a.request.JSON,n.exports=c):n.lanyrd=c}(this.lanyrd,this.jQuery,"undefined"!=typeof module?module:this),function(){if(function(e){function t(e){var t,n,r=d[e]={};for(e=e.split(/\s+/),t=0,n=e.length;t<n;t++)r[e[t]]=!0;return r}var n={},r=Array.prototype,i=Object.prototype,o=i.hasOwnProperty,u=i.toString,a=r.forEach,c=r.slice,s=function(e,t,r){var i,u,c;if(e)if(a&&e.forEach===a)e.forEach(t,r);else if(e.length===+e.length){for(u=0,c=e.length;u<c;u++)if(u in e&&t.call(r,e[u],u,e)===n)return}else for(i in e)if(o.call(e,i)&&t.call(r,e[i],i,e)===n)return},l=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},f={"[object Array]":"array","[object Function]":"function"},h=function(e){return e?f[u.call(e)]||"object":String(e)},p=("done fail isResolved isRejected promise then always pipe".split(" "),{}),d={};p.Callbacks=function(e){e=e?d[e]||t(e):{};var n,r,i,o,u,a=[],c=[],s=function(t){var n,r,i,o;for(n=0,r=t.length;n<r;n++)i=t[n],o=h(i),"array"===o?s(i):"function"===o&&(e.unique&&f.has(i)||a.push(i))},l=function(t,s){for(s=s||[],n=!e.memory||[t,s],r=!0,u=i||0,i=0,o=a.length;a&&u<o;u++)if(a[u].apply(t,s)===!1&&e.stopOnFalse){n=!0;break}r=!1,a&&(e.once?n===!0?f.disable():a=[]:c&&c.length&&(n=c.shift(),f.fireWith(n[0],n[1])))},f={add:function(){if(a){var e=a.length;s(arguments),r?o=a.length:n&&n!==!0&&(i=e,l(n[0],n[1]))}return this},remove:function(){if(a)for(var t=arguments,n=0,i=t.length;n<i;n++)for(var c=0;c<a.length&&(t[n]!==a[c]||(r&&c<=o&&(o--,c<=u&&u--),a.splice(c--,1),!e.unique));c++);return this},has:function(e){if(a)for(var t=0,n=a.length;t<n;t++)if(e===a[t])return!0;return!1},empty:function(){return a=[],this},disable:function(){return a=c=n=void 0,this},disabled:function(){return!a},lock:function(){return c=void 0,n&&n!==!0||f.disable(),this},locked:function(){return!c},fireWith:function(t,i){return c&&(r?e.once||c.push([t,i]):e.once&&n||l(t,i)),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!n}};return f},p.Deferred=function(e){var t,n=p.Callbacks("once memory"),r=p.Callbacks("once memory"),i=p.Callbacks("memory"),o="pending",u={resolve:n,reject:r,notify:i},a={done:n.add,fail:r.add,progress:i.add,state:function(){return o},isResolved:n.fired,isRejected:r.fired,then:function(e,t,n){return c.done(e).fail(t).progress(n),this},always:function(){return c.done.apply(c,arguments).fail.apply(c,arguments),this},pipe:function(e,t,n){return p.Deferred(function(r){s({done:[e,"resolve"],fail:[t,"reject"],progress:[n,"notify"]},function(e,t){var n,i=e[0],o=e[1];l(i)?c[t](function(){n=i.apply(this,arguments),n&&l(n.promise)?n.promise().then(r.resolve,r.reject,r.notify):r[o+"With"](this===c?r:this,[n])}):c[t](r[o])})}).promise()},promise:function(e){if(e)for(var t in a)e[t]=a[t];else e=a;return e}},c=a.promise({});for(t in u)c[t]=u[t].fire,c[t+"With"]=u[t].fireWith;return c.done(function(){o="resolved"},r.disable,i.lock).fail(function(){o="rejected"},n.disable,i.lock),e&&e.call(c,c),c},p.when=function(e){function t(e){return function(t){r[e]=arguments.length>1?c.call(arguments,0):t,--a||s.resolveWith(s,r)}}function n(e){return function(t){u[e]=arguments.length>1?c.call(arguments,0):t,s.notifyWith(f,u)}}var r=c.call(arguments,0),i=0,o=r.length,u=new Array(o),a=o,s=o<=1&&e&&l(e.promise)?e:p.Deferred(),f=s.promise();if(o>1){for(;i<o;i++)r[i]&&r[i].promise&&l(r[i].promise)?r[i].promise().then(t(i),s.reject,n(i)):--a;a||s.resolveWith(s,r)}else s!==e&&s.resolveWith(s,o?[e]:[]);return f},"undefined"!=typeof module&&module.exports?module.exports=p:"undefined"!=typeof e._?e._.mixin(p):e._=p}(this),"undefined"!=typeof module&&module.exports){var e=module.exports;module.exports=function(t){t._=e}}}.call(this.lanyrd&&this.lanyrd.utils),function(e){function t(){var e,n=t.cached,r=null;if(n)return n();e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];do{n=e.shift();try{r=n(),t.cached=n;break}catch(i){}}while(e.length);return r}function n(e,n){var r=t(),i=lanyrd.utils.deferred();return r.open("GET",e,!0),r.onreadystatechange=function(){var e;if(4===r.readyState)try{r.status>=200&&r.status<300?(e=JSON.parse(r.responseText),i.resolve(e,r)):i.reject(r)}catch(t){i.reject(r,t)}},4!==r.readyState&&r.send(),i.promise(r).done(n)}function r(e,t){var n=lanyrd.utils.deferred(),r=document.createElement("script"),u="callback"+(o+=1);encodeURIComponent;return e=e.replace(/\?$/,u),window[u]=function(e){n.resolve(e),delete window[u]},r.src=e,r.onload=r.onreadystatechange=function(){r.readyState&&!/loaded|complete/.test(r.readyState)||(r.onload=r.onreadystatechange=null,r.parentNode.removeChild(r),r=void 0)},i.insertBefore(r,i.lastChild),setTimeout(n.reject,3e4),n.promise().done(t)}if("undefined"!=typeof module&&module.exports)return function(){var e=require("url"),t=require("http");module.exports=function(n){return n.json=n.jsonp=function(r,i){var o=e.parse(r),u=n.deferred(),a=u.promise();return a.xhr=t.get(o,function(e){var t=[];e.on("data",function(e){t.push(e)}),e.on("end",function(){try{e.statusCode>=200&&e.statusCode<300?u.resolve(JSON.parse(t.join()),e):u.reject(e)}catch(n){u.reject(e,n)}})}),a},n}}();var i=document.getElementsByTagName("head")[0],o=0;lanyrd.utils.json=n,lanyrd.utils.jsonp=r}(this.lanyrd&&this.lanyrd.utils);
//# sourceMappingURL=lanyrd.js.map
