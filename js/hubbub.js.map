{
  "version": 3,
  "sources": ["../../_assets/scripts/hubbub.js"],
  "sourcesContent": ["/*!\n    Hubbub\n\n    by Chris Newton <http://chrisnewtn.com>,\n       Seanewt <http://seanewt.com>,\n       Dharmafly <http://dharmafly.com>\n\n    Repo: <https://github.com/asyncjs/hubbub>\n    MIT license\n*/\n\nHubbub = (function() {\n\n  \"use strict\";\n\n  if ( ![].forEach || !window.XMLHttpRequest ) {\n    return;\n  }\n\n  var containerClass = \"hubbub\",\n      gistUrlAttr    = \"data-gist-url\",\n      apiRoot        = \"https://api.github.com/\",\n      widgets        = document.querySelectorAll( \".\" + containerClass ),\n      hubbub         = {},\n      useFixtures    = false;\n\n  var cssClass = {\n    avatar: \"hubbub-avatar\",\n    avatarLink: \"hubbub-avatar-link\",\n    header: \"hubbub-header\",\n    username: \"hubbub-username\",\n    commentBody: \"hubbub-comment-body\",\n    timestamp: \"hubbub-timestamp\",\n    permalink: \"hubbub-permalink\",\n    content: \"hubbub-content\",\n    container: \"hubbub-container\"\n  };\n\n  var cache = (function() {\n    var key  = \"hubbub-\",\n        life = 60 * 60 * 1000;\n\n    return {\n      has: function( id ) {\n        return localStorage.getItem( key + id ) !== null;\n      },\n      get: function( id ) {\n        var blob = JSON.parse( localStorage.getItem( key + id ) );\n        if ( blob !== null ) {\n          if ( (Date.now() - blob.createdAt) > life ) {\n            localStorage.removeItem( key + id );\n          }\n        }\n        return blob.comments;\n      },\n      set: function( id, comments ) {\n        var blob = { comments: comments, createdAt: Date.now() };\n        localStorage.setItem( key + id, JSON.stringify( blob ) );\n      }\n    };\n  })();\n\n  // Initial setup\n  [].forEach.call( widgets, function( el ) {\n    getComments( el, renderComments );\n  });\n\n  function getComments ( el, callback ) {\n    var gistId = el.getAttribute( gistUrlAttr ).match( /\\/(\\w+)\\/?$/ )[ 1 ];\n\n    if ( cache.has( gistId ) ) {\n      callback( el, cache.get( gistId ), gistId );\n    } else {\n      var url;\n      if ( useFixtures ) {\n        url = \"fixtures/\" + gistId + \".json\";\n      } else {\n        url = apiRoot + \"gists/\" + gistId + \"/comments\";\n      }\n      ajax({\n        url:url,\n        dataType: \"json\"\n      }, function( comments ) {\n        parseMarkdown( comments, gistId, el, callback );\n      }, function( err ) {\n        el.innerHTML = el.innerHTML + \"<small>Error fetching Comments</small>\";\n      });\n    }\n  }\n\n  function parseMarkdown ( comments, gistId, el, callback ) {\n    var opts = {\n      url: apiRoot + \"markdown\",\n      reqDataType: \"json\",\n      type: \"POST\"\n    };\n    var delimiter = String.fromCharCode( 0x3091 );\n\n    var reqText = comments.reduce(function( mem, curr ) {\n      return mem + curr.body + \"\\r\\n\\r\\n\" + delimiter + \"\\r\\n\\r\\n\";\n    }, \"\" );\n\n    opts.data = { text: reqText };\n\n    ajax( opts, function( blob ) {\n      var parsedComments = blob.split( \"<p>\" + delimiter + \"</p>\" );\n      parsedComments.forEach(function( comment, i ) {\n        if ( comments[ i ] ) {\n          comments[ i ].html_body = comment.trim();\n        }\n      });\n      cache.set( gistId, comments );\n      callback( el, comments );\n    });\n  }\n\n  function renderComments ( el, comments ) {\n    var heading = document.createElement( \"h3\" );\n    heading.setAttribute(\"class\", \"heading\" );\n    var link = document.createElement(\"a\" );\n    link.setAttribute(\"href\", el.getAttribute( gistUrlAttr ) );\n    link.textContent = \"Comments (\" + comments.length + \")\";\n    heading.appendChild( link );\n    el.appendChild( heading );\n\n    comments.forEach(function( comment ) {\n      el.appendChild( renderComment( el, comment ) );\n    });\n  }\n\n  function renderComment ( container, comment ) {\n    var el = document.createElement(\"div\" );\n    el.setAttribute(\"class\", cssClass.container );\n    el.appendChild( renderAvatar( comment.user ) );\n\n    var content = document.createElement(\"div\" );\n    content.setAttribute(\"class\", cssClass.content );\n    content.appendChild( renderHeader( container, comment ) );\n    content.appendChild( renderCommentBody( comment ) );\n\n    el.appendChild( content );\n    return el;\n  }\n\n  function renderHeader ( container, comment ) {\n    var header = document.createElement(\"div\" );\n    header.setAttribute( \"class\", cssClass.header );\n\n    var un = document.createElement(\"a\" );\n    un.setAttribute( \"class\", cssClass.username );\n    un.setAttribute(\"href\", comment.user.html_url );\n    un.innerHTML = \"<b>\" + comment.user.login + \"</b>\";\n\n    var commentUrl = container.getAttribute( gistUrlAttr );\n    commentUrl = commentUrl + \"#comment-\" + comment.id;\n\n    var pl = document.createElement(\"a\" );\n    pl.setAttribute( \"class\", cssClass.permalink );\n    pl.setAttribute(\"href\", commentUrl );\n    pl.textContent = \"commented\";\n\n    header.appendChild( un );\n    header.appendChild( pl );\n    header.appendChild( renderTimestamp( comment.created_at ) );\n    return header;\n  }\n\n  function renderTimestamp ( timestamp ) {\n    var diff = Date.now() - new Date( timestamp ).getTime();\n    var el = document.createElement(\"time\" );\n    el.setAttribute( \"class\", cssClass.timestamp );\n    el.setAttribute( \"datetime\", timestamp );\n    el.setAttribute(\"title\", timestamp );\n\n    diff = Math.round( diff / 1000 );\n    var str;\n\n    if ( diff < 3600 ) {\n      str = Math.round( diff / 60 ) + \" minutes ago\";\n    } else if ( diff < 86400 ) {\n      var hours = Math.round( diff / 3600 );\n      str = hours === 1 ? \"an hour ago\" : hours + \" hours ago\";\n    } else {\n      var days = Math.round( diff / 86400 );\n      str = days === 1 ? \"yesterday\" : days + \" days ago\";\n    }\n\n    el.textContent = str;\n\n    return el;\n  }\n\n  function renderCommentBody ( comment ) {\n    var body = document.createElement(\"div\" );\n    body.setAttribute(\"class\", cssClass.commentBody );\n    body.innerHTML = comment.html_body;\n    return body;\n  }\n\n  function ajax ( options, success, error ) {\n    var req = new XMLHttpRequest();\n    options.type = options.type || \"GET\";\n    req.addEventListener( \"readystatechange\", function( res ) {\n      if ( req.readyState === 4 && req.status === 200 ) {\n        var data;\n        if ( options.dataType === \"json\" ) {\n          data = JSON.parse( res.target.responseText );\n        } else {\n          data = res.target.responseText;\n        }\n        success( data, res );\n      } else if ( req.readyState === 4 ) {\n        if ( error ) {\n          error( res );\n        }\n      }\n    });\n    req.open( options.type, options.url, true );\n    if ( options.reqDataType === \"json\" ) {\n      req.setRequestHeader(\"Content-type\", \"application/json\" );\n      req.send( JSON.stringify( options.data ) );\n    } else {\n      req.send( options.data );\n    }\n  }\n\n  function renderAvatar ( user ) {\n    var a = document.createElement( \"a\" );\n    a.setAttribute( \"href\", user.html_url );\n    a.setAttribute(\"class\", cssClass.avatarLink );\n    var img = document.createElement( \"img\" );\n    img.setAttribute(\"class\", cssClass.avatar );\n    img.setAttribute( \"src\", user.avatar_url );\n    img.setAttribute( \"width\", 48 );\n    img.setAttribute( \"height\", 48 );\n    a.appendChild( img );\n    return a;\n  }\n\n  hubbub.appendWidget = function( el, gistUrl ) {\n    var div = document.createElement(\"div\" );\n    div.setAttribute(\"class\", containerClass );\n    div.setAttribute( gistUrlAttr, gistUrl );\n    el.appendChild( div );\n    getComments( div, renderComments );\n  };\n\n  hubbub.css = cssClass;\n\n  return hubbub;\n})();\n"],
  "mappings": "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",
  "names": ["containerClass", "gistUrlAttr", "apiRoot", "widgets", "hubbub", "useFixtures", "cssClass", "cache", "key", "life", "id", "blob", "comments", "el", "getComments", "renderComments", "callback", "gistId", "url", "ajax", "parseMarkdown", "err", "opts", "delimiter", "reqText", "mem", "curr", "parsedComments", "comment", "i", "heading", "link", "renderComment", "container", "renderAvatar", "content", "renderHeader", "renderCommentBody", "header", "un", "commentUrl", "pl", "renderTimestamp", "timestamp", "diff", "str", "hours", "days", "body", "options", "success", "error", "req", "res", "data", "user", "a", "img", "gistUrl", "div"]
}
