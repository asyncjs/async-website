{"version":3,"sources":["main.js"],"names":["document","querySelectorAll","setupLanyrd","lanyrd","event","target","url","container","upcoming","eventUrlRegex","querySelector","href","test","createElement","className","appendChild","widget","people","append","headingLevel","done","style","more","parentNode","removeChild","utils","each","parts","this","innerHTML","split","count","shift","classList","add","join","item","getAttribute","conference","fetch","requests","related","when","then","trackers","arguments","attendees","get","setupHubbub","loadScript","script","onload","setupWidgets","window","Hubbub","src","body","css","avatarLink","forEach","call","gists","gist","section","setAttribute","appendWidget","length","getElementById","isWide","getComputedStyle","width","scripts","remaining","createFrame","type","iframe","div","createSection","title","heading","media","createTextNode","link","data","dataset","video","slides","replace","email","$0","$1","at","dot","emails","lanyrdLinks","words","wrap","clone","parent","prev","previousSibling","nodeType","nodeValue","trim","pop","cloneNode"],"mappings":"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","file":"main.js","sourcesContent":["if ( document.querySelectorAll ) {\n  (function() {\n    var test    = document.getElementById(\"media-test\" ),\n        isWide  = test && window.getComputedStyle( test, null ).width === \"1px\",\n        scripts = [ \"lanyrd\", \"lanyrd.widget\" ],\n        remaining = scripts.length;\n\n    if ( isWide ) {\n      (function loadScript( src ) {\n        var script = document.createElement(\"script\");\n        script.onload = function() {\n          remaining -= 1;\n          if ( remaining === 0 ) {\n            setupLanyrd( window.lanyrd );\n            setupHubbub();\n          } else {\n            loadScript( scripts.shift() );\n          }\n        };\n        script.src = \"/js/\" + src + \".js\";\n        document.body.appendChild( script );\n      })( scripts.shift() );\n\n      (function embedSlides() {\n        function createFrame( src, type ) {\n          var div = document.createElement( \"div\" ), iframe;\n          div.className = \"iframe-wrapper iframe-\" + type;\n\n          iframe = document.createElement(\"iframe\" );\n          iframe.src = src;\n          iframe.width = \"100%\";\n          iframe.className = \"iframe\";\n\n          div.appendChild( iframe );\n          return div;\n        }\n\n        function createSection( title, type ) {\n          var media = document.querySelectorAll( \"[data-\" + type + \"]\" ),\n              section, heading;\n\n          if ( media.length ) {\n            section = document.createElement( \"section\" );\n            section.className = \"extra \" + type;\n\n            heading = document.createElement(\"h3\" );\n            heading.className = \"heading\";\n            heading.appendChild( document.createTextNode( title ) );\n\n            section.appendChild( heading );\n\n            [].forEach.call( media, function( link ) {\n              var data = link.dataset,\n                  src = data && (data.video || data.slides) || link.href;\n\n              section.appendChild( createFrame( src, type ) );\n            });\n\n            document.querySelector(\".event-detail\" ).appendChild( section );\n          }\n        }\n\n        createSection( \"Slides\", \"slides\" );\n        createSection(\"Videos\", \"video\" );\n      })();\n    } else {\n      setupHubbub();\n    }\n\n    function setupLanyrd( lanyrd ) {\n      var event, target, url, container, upcoming, eventUrlRegex;\n\n      eventUrlRegex = /^\\s*https?:\\/\\/(?:www.)?lanyrd.com\\/\\d{4}\\/[a-z0-9\\-]+\\/\\s*$/;\n      event = document.querySelector( \".event-detail\" );\n      if ( event ) {\n        target = event.querySelector( \".lanyrd-link\" );\n        url = target && target.href;\n\n        if ( url && eventUrlRegex.test( url ) ) {\n          container = document.createElement( \"section\" );\n          container.className = \"extra lanyrd\";\n          event.appendChild( container );\n\n          lanyrd.widget.people([ url ], container, {\n            append: true,\n            headingLevel: 3\n          }).done(function() {\n            var style, more;\n\n            style = container.querySelector( \"style\" );\n            style.parentNode.removeChild( style );\n\n            more = container.querySelector(\"p\" );\n            more.parentNode.removeChild( more );\n\n            lanyrd.utils.each( container.querySelectorAll(\"h3\" ), function() {\n              var parts = this.innerHTML.split( \" \" ),\n                  count = parts.shift();\n\n              this.classList.add(\"heading\" );\n              this.innerHTML = parts.join( \" \" ) + \" (\" + count + \")\";\n            });\n\n            lanyrd.utils.each( container.querySelectorAll(\"li a\" ), function() {\n              this.classList.add( \"bordered\" );\n            });\n          });\n        }\n      }\n\n      upcoming = document.querySelectorAll( \".event-item\" );\n\n      lanyrd.utils.each( upcoming, function() {\n        var item = this,\n            target = this.querySelector( \".lanyrd-link\" ),\n            url = target && target.getAttribute(\"href\" );\n\n        if ( url && eventUrlRegex.test( url ) ) {\n          lanyrd.conference( target.href ).fetch(function( conference ) {\n            var requests = [\n              conference.related(\"conference.attendees\" ).fetch(),\n              conference.related(\"conference.trackers\" ).fetch()\n            ];\n\n            lanyrd.utils.when( requests ).then(function() {\n              var trackers  = arguments[ 1 ][ 0 ],\n                  attendees = arguments[ 0 ][ 0 ],\n                  container = document.createElement( \"p\" );\n\n              container.className = \"lanyrd-simple\";\n              container.innerHTML = [\n                attendees.get(\"pagination.total\" ),\n                \"attending\",\n                \"&bull;\",\n                trackers.get(\"pagination.total\" ),\n                \"tracking\"\n              ].join( \" \" );\n              item.appendChild( container );\n            });\n          });\n        }\n      });\n    }\n\n    function setupHubbub () {\n      var gists = document.querySelectorAll( \"a[data-gist]\" );\n\n      function loadScript () {\n        var script = document.createElement(\"script\" );\n        script.onload = function() {\n          setupWidgets( window.Hubbub );\n        };\n        script.src = \"/js/hubbub.js\";\n        document.body.appendChild( script );\n      }\n\n      function setupWidgets ( Hubbub ) {\n        Hubbub.css.avatarLink = \"hubbub-avatar-link bordered\";\n        [].forEach.call( gists, function( gist ) {\n          var section = document.createElement( \"section\" );\n          section.setAttribute( \"class\", \"extra\" );\n          document.querySelector( \"section.event-detail\" ).appendChild( section );\n          Hubbub.appendWidget( section, gist.href );\n        });\n      }\n\n      if ( gists.length < 1 ) {\n        return;\n      }\n\n      loadScript();\n    }\n  })();\n\n  (function buildEmails() {\n    var emails = document.querySelectorAll(\"a[href^=mailto]\" );\n\n    function replace( email ) {\n      return email.replace( /(?:%20| )\\[([^\\]]+)\\](?:%20| )/g, function( $0, $1 ) {\n        return { at: \"@\", dot: \".\" }[ $1 ] || $0;\n      });\n    }\n\n    [].forEach.call( emails || [], function( link ) {\n      link.href = replace( link.href );\n      link.innerHTML = replace( link.innerHTML );\n    });\n  })();\n\n  // No longer required since Metalsmith update\n  // (function removeOldNews() {\n  //   var news = document.querySelectorAll( \".news\" ),\n  //       expires = new Date().getTime() - (30 * 24 * 60 * 60 * 1000);\n\n  //   [].forEach.call( news || [], function( element ) {\n  //     var time = Date.parse( element.getAttribute( \"data-timestamp\" ) );\n  //     if ( time < expires ) {\n  //       element.parentNode.removeChild( element );\n  //     }\n  //   });\n  // })();\n\n  (function preventOrphanedLanyrdIcons() {\n    var lanyrdLinks = document.querySelectorAll(\".lanyrd-link\" );\n\n    [].forEach.call( lanyrdLinks || [], function( link ) {\n      var parent = link.parentNode,\n          prev = link.previousSibling, words, wrap, clone;\n\n      while ( prev && prev.nodeType === 3 && !prev.nodeValue.trim() ) {\n        prev = prev.previousSibling;\n      }\n\n      if ( prev ) {\n        if ( prev.nodeType === 3 ) {\n          words = prev.nodeValue.trim().split(\" \");\n        } else {\n          words = prev.innerHTML.split(\" \");\n        }\n\n        wrap = document.createElement(\"span\" );\n        wrap.className = \"no-wrap\";\n\n        if ( words.length > 1 ) {\n          if ( prev.nodeType === 3 ) {\n            clone = document.createTextNode( words.pop() );\n            prev.nodeValue = words.join(\" \") + \" \";\n          } else {\n            clone = prev.cloneNode();\n            clone.innerHTML = words.pop();\n            prev.innerHTML = words.join(\" \") + \" \";\n          }\n\n          wrap.appendChild( clone );\n        } else {\n          wrap.appendChild( prev );\n        }\n\n        wrap.appendChild( link );\n        parent.appendChild( wrap );\n      }\n    });\n  })();\n}\n"]}